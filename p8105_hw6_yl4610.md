p8105_hw6_yl4610
================
Yuxin Liu
2022-11-21

``` r
library(tidyverse)
```

# Question 2

``` r
homicide_raw = 
  read_csv( "./data/homicide_data.csv") %>% 
    mutate (
    city_state = str_c(city, ", ", state),
    result = ifelse(disposition != "Closed by arrest", "unsolved", "solved")) %>% 
    filter(!(city_state %in% c("Tulsa, AL", "Dallas, TX", "Phoenix, AZ", "Kansas City, MO"))) %>% 
    filter(victim_race %in% c("White", "Black")) %>% 
    filter(!(victim_age %in% c("Unknown"))) %>% 
    mutate (victim_age = as.numeric(victim_age))

homicide_raw 
```

    ## # A tibble: 39,403 × 14
    ##    uid   repor…¹ victi…² victi…³ victi…⁴ victi…⁵ victi…⁶ city  state   lat   lon
    ##    <chr>   <dbl> <chr>   <chr>   <chr>     <dbl> <chr>   <chr> <chr> <dbl> <dbl>
    ##  1 Alb-…  2.01e7 SATTER… VIVIANA White        15 Female  Albu… NM     35.1 -107.
    ##  2 Alb-…  2.01e7 MULA    VIVIAN  White        72 Female  Albu… NM     35.1 -107.
    ##  3 Alb-…  2.01e7 BOOK    GERALD… White        91 Female  Albu… NM     35.2 -107.
    ##  4 Alb-…  2.01e7 MARTIN… GUSTAVO White        56 Male    Albu… NM     35.1 -107.
    ##  5 Alb-…  2.01e7 GRAY    STEFAN… White        43 Female  Albu… NM     35.1 -107.
    ##  6 Alb-…  2.01e7 DAVID   LARRY   White        52 Male    Albu… NM     NA     NA 
    ##  7 Alb-…  2.01e7 BRITO   ELIZAB… White        22 Female  Albu… NM     35.1 -107.
    ##  8 Alb-…  2.01e7 KING    TEVION  Black        15 Male    Albu… NM     35.1 -107.
    ##  9 Alb-…  2.01e7 BOYKIN  CEDRIC  Black        25 Male    Albu… NM     35.1 -107.
    ## 10 Alb-…  2.01e7 BARRAG… MIGUEL  White        20 Male    Albu… NM     35.1 -107.
    ## # … with 39,393 more rows, 3 more variables: disposition <chr>,
    ## #   city_state <chr>, result <chr>, and abbreviated variable names
    ## #   ¹​reported_date, ²​victim_last, ³​victim_first, ⁴​victim_race, ⁵​victim_age,
    ## #   ⁶​victim_sex

I used mutate to create a city_state variable and a binary variable
indicating whether the homicide is solved. I used filter to omit cities
Dallas, TX; Phoenix, AZ; and Kansas City, MO; Tulsa, AL. Also, I used
filter to limit victim_race as White or Black and delete unknown age.
Lastly, I used mutate to change victim_age to numeric format.

``` r
Baltimore_reg = 
 homicide_raw %>% 
  filter(city_state == "Baltimore, MD") %>%
  mutate (y_var = ifelse(result == "solved",0,1)) %>% 
    glm(y_var ~ victim_age + victim_sex + victim_race, data =., family = 'binomial'(link='logit')) %>% 
    broom::tidy () %>% 
    mutate(odds_ratio = exp(estimate)) 

Baltimore_reg
```

    ## # A tibble: 4 × 6
    ##   term             estimate std.error statistic  p.value odds_ratio
    ##   <chr>               <dbl>     <dbl>     <dbl>    <dbl>      <dbl>
    ## 1 (Intercept)      -0.310     0.171       -1.81 7.04e- 2      0.733
    ## 2 victim_age        0.00673   0.00332      2.02 4.30e- 2      1.01 
    ## 3 victim_sexMale    0.854     0.138        6.18 6.26e-10      2.35 
    ## 4 victim_raceWhite -0.842     0.175       -4.82 1.45e- 6      0.431

For the city of Baltimore, MD, I used the glm function to fit a logistic
regression with resolved vs unresolved as the outcome and victim age,
sex and race as predictors. Save the output of glm as an R object; apply
the broom::tidy to this object; and obtain the estimate and confidence
interval of the adjusted odds ratio for solving homicides comparing male
victims to female victims keeping all other variables fixed.
